```bsl
// Код разрабатывался в обычном приложении

Процедура ПоказатьПрогрессВыполнения(Всего, Сч, СтрокаСообщения = "", Шаг = 5, ИмяСобытия)
	
	Если ЗначениеЗаполнено(СтрокаСообщения) Тогда
		СтрокаСообщения = СтрокаСообщения + ": ";
	КонецЕсли;
	
	СтрокаСообщения = СтрокаСообщения + Формат(Сч / Всего * 100, "ЧДЦ=2") + "% (" + Сч + "/"+ Всего + ")";
	#Если Клиент Тогда
		Состояние(СтрокаСообщения);
		ОбработкаПрерыванияПользователя();
	#Иначе
		Если НЕ ЗначениеЗаполнено(ИмяСобытия) Тогда
			ИмяСобытия = "Безымянное событие";
		КонецЕсли;
		Если (Сч / Всего * 100) >= Шаг ИЛИ Сч = 0 Тогда 
			ЗаписьЖурналаРегистрации(ИмяСобытия, УровеньЖурналаРегистрации.Информация, , , СтрокаСообщения);
			Шаг = Шаг + Шаг;
		КонецЕсли;
	#КонецЕсли
	
	Сч = Сч + 1;

КонецПроцедуры

Процедура ПоказатьСостояние(СтрокаСообщения, ИмяСобытия = "", УровеньЖурнала = Неопределено)
	
	Если УровеньЖурнала = Неопределено Тогда
		УровеньЖурнала = УровеньЖурналаРегистрации.Информация;
	КонецЕсли;	
	
	Если НЕ ЗначениеЗаполнено(ИмяСобытия) Тогда
		ИмяСобытия = "Безымянное событие";
	КонецЕсли;
	
	#Если Клиент Тогда
		Состояние("1/5 Подготовка данных");
	#Иначе	
		ЗаписьЖурналаРегистрации(ИмяСобытия, УровеньЖурнала, , , СтрокаСообщения);
	#КонецЕсли

КонецПроцедуры

```
