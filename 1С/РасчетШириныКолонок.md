```bsl
Процедура РасчетШириныКолонок(ТабличныйДокумент, НачалоТаблицыПослеШапки, ЗаголовокСостояния = "")
	ВсегоПройти = (ТабличныйДокумент.ВысотаТаблицы - НачалоТаблицыПослеШапки + 1) * ТабличныйДокумент.ШиринаТаблицы;
	Счетчик = 0;
	МаксШиринаКолонки = 40;
	Для Кол = 1 По ТабличныйДокумент.ШиринаТаблицы Цикл
		ШиринаКолонки = 0;
		ШиринаПоУмолчанию = ТабличныйДокумент.Область("R"+Формат(НачалоТаблицыПослеШапки-1,"ЧГ=0")+"C"+Формат(Кол,"ЧГ=0")).ШиринаКолонки;
		Счетчик = Счетчик + 1;
		Состояние("Расчет ширины колонок: "+  Формат(Счетчик / ВсегоПройти * 100, "ЧДЦ=0") + "%");
		ПерваяИтерация = Истина;
		Для Стр = НачалоТаблицыПослеШапки По ТабличныйДокумент.ВысотаТаблицы Цикл
            Область = ТабличныйДокумент.Область("R"+Формат(Стр,"ЧГ=0")+"C"+Формат(Кол,"ЧГ=0"));
            ШиринаОбласти = Область.Отступ+СтрДлина(СокрЛП(Область.Текст))+1.5;
            ШиринаКолонки = Макс(ШиринаКолонки, ШиринаОбласти, ШиринаПоУмолчанию);
            Если ШиринаКолонки > МаксШиринаКолонки Тогда
                Область.ШиринаКолонки = МаксШиринаКолонки;
            Иначе
                Область.ШиринаКолонки = ШиринаКолонки;
			КонецЕсли;
			Если НЕ ПерваяИтерация Тогда
				Счетчик = Счетчик + 1;
			КонецЕсли;
			Если ЗначениеЗаполнено(ЗаголовокСостояния) Тогда
				Состояние(ЗаголовокСостояния + ", расчет ширины колонок: "+  Формат(Счетчик / ВсегоПройти * 100, "ЧДЦ=0") + "%");
			Иначе
				Состояние("Расчет ширины колонок: "+  Формат(Счетчик / ВсегоПройти * 100, "ЧДЦ=0") + "%");
			КонецЕсли;	
			ПерваяИтерация = Ложь;
		Конеццикла;
    КонецЦикла;
КонецПроцедуры
```
